version: 1
env:
  runtime: nodejs22.x

frontend:
  phases:
    preBuild:
      commands:
        - echo "🔎 Preflight AWS account"
        - node scripts/preflight-aws-account.js
        - corepack enable
        - corepack prepare pnpm@9.12.3 --activate
        - pnpm -v && node -v
        - pnpm -w install --no-frozen-lockfile
    build:
      commands:
        - echo "🏗️ Building frontend only"
        - cd frontend && pnpm build
  artifacts:
    baseDirectory: frontend/.next
    files:
      - '**/*'
  cache:
    paths:
      - .npm-cache/**/*
      - node_modules/**/*
      - frontend/node_modules/**/*
      - pnpm-store/**/*
